---
import Footer from "../components/Footer.astro";
import Layout from "../layouts/Layout.astro";
---

<Layout title="Psychological Personalization | PSYKHE">
  <!-- SF Tech Week Banner -->
  <div class="sf-tech-week-banner">
    <a
      href="https://partiful.com/e/Mtc4YgjhitzbB7TmcFLs"
      target="_blank"
      rel="noopener noreferrer"
    >
      PSYKHE AI is hosting with a16z at SF Tech Week (Oct 14–20, San Francisco)
    </a>
  </div>

  <div class="home-wrapper">
    <div class="psykhe-landing">
      <div class="psykhe-b2b">
        <div class="outer">
          <div class="circuit"></div>
          <div class="inner">
            <div class="gradient">
              <div class="flex flex-wrap top">
                <div class="w-full md:w-1/4">
                  <img
                    src="/media/b2b/ww/logoword2.svg"
                    alt="PSYKHE AI logo"
                    style="width: 100%; height: auto;"
                  />
                </div>
                <div class="nav-case-studies">
                  <a href="#case-studies">Case&nbsp;Studies </a>
                </div>
                <div class="nav-book-demo">
                  <a href="#signup">Book&nbsp;a&nbsp;Demo</a>
                </div>
              </div>

              <div class="flex flex-wrap">
                <div class="w-full md:w-1/2 lead">
                  <h2>
                    The world's smartest AI-merchandising engine, powered by
                    patented psychographic intelligence.
                  </h2>
                  <div class="lead-content">
                    <p>
                      The right products. The right order. For every shopper,
                      every time.
                    </p>
                  </div>
                  <div class="lead-button">
                    <a class="learn-more" href="#signup">Learn More</a>
                  </div>
                  <div class="lead-button case-study-button">
                    <a class="learn-more" href="#case-studies">Case Studies</a>
                  </div>
                </div>
                <div class="hidden md:block md:w-1/2 callouts">
                  <button class="callout-personalized btn-b2b btn-gradient"
                    >PERSONALIZED MERCHANDISING</button
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="psykhe-b2b-content">
        <div class="flex flex-wrap">
          <div class="flex-1 circular">
            <span class="circle">&nbsp;6X</span>
            <span class="circle-label"
              >INCREASE IN CONVERSION RATE THROUGH PSYKHE AI's MODELS</span
            >
          </div>
          <div class="flex-1 circular">
            <span class="circle">65%</span>
            <span class="circle-label"
              >missed sales opportunities due to static PLPs (category pages)</span
            >
          </div>
          <div class="flex-1 circular">
            <span class="circle">11X</span>
            <span class="circle-label"
              >AOV increase due to surfacing relevant adjacencies</span
            >
          </div>
        </div>
      </div>

      <div class="psykhe-b2b-compare-screens">
        <div class="cs-inner">
          <div class="cs-text-block">
            <div class="flex flex-wrap">
              <div class="w-full md:flex-1 cs-lead">
                <h2>Turn Data Into Dollars</h2>
                <div class="cs-lead-content">
                  <p>
                    People can't buy what they can't see, and it's impossible to
                    manually curate for millions of online customers. PSYKHE AI
                    is the brain of a super personal-shopper at scale, who
                    instantly gets everyone.
                  </p>
                </div>
              </div>
            </div>
          </div>

          <div class="text-center">
            <img
              src="/media/b2b/ww/compare_screen.png"
              class="max-w-full h-auto d"
              alt="Compare Screens"
            />
            <img
              src="/media/b2b/ww/compare_screen_mobile.png"
              class="max-w-full h-auto m"
              alt="Compare Screens"
            />
          </div>
        </div>
      </div>
      <div class="compare-screen-labels-outer">
        <!--      <div class="compare-screen-labels">
          <div class="compare-screen-label-column a">
            <img src="/media/b2b/ww/the_status_quo.svg" class="max-w-full h-auto" />
          </div>
          <div class="compare-screen-label-column b">
            <img src="/media/b2b/ww/psykhe.svg" class="max-w-full h-auto" />
          </div>
        </div>-->
      </div>

      <div class="psykhe-ai-case-studies">
        <div class="psykhe-ai-case-studies-in">
          <div class="psykhe-ai-case-studies-in-text">
            <h2 id="case-studies">Case Studies</h2>
          </div>

          <!-- Carousel Container - Requires a library (e.g., vue-slick-carousel, swiper) or custom JS for functionality -->
          <div class="case-studies-carousel">
            <!-- MY -->
            <div class="case-studies-slide">
              <div class="case-studies-content">
                <h3>
                  Mine & Yours achieved a +15.6% increase in sustained
                  Conversion Rate thanks to PSYKHE AI's real-time per-user
                  AI-merchandising
                </h3>
                <p>
                  "As a resale platform, our inventory is one-of-a-kind -
                  literally. PSYKHE AI somehow just gets taste. It's like having
                  the most intuitive shop-floor stylist built into the site,
                  always pulling the perfect pieces for each customer."
                </p>
                <cite>— Courtney Watkins, Owner, Mine & Yours</cite>
                <p class="methodology-text">
                  <b>Methodology:</b> We ran a clean A/B test over three months on
                  category pages (PLPs). One group used PSYKHE AI's psychographic-powered,
                  real-time PLP ranking; the other relied on the site's existing
                  sort logic.
                </p>
              </div>
              <div class="case-studies-image">
                <img
                  src="/media/b2b/ww/case-studies/my_courtney_watkins.png"
                  alt="Courtney Watkins, Owner, Mine & Yours"
                />
              </div>
            </div>

            <!-- KZ -->
            <div class="case-studies-slide">
              <div class="case-studies-content">
                <h3>
                  Kirna Zabête achieved an +18% increase in Revenue-Per-Visitor
                  thanks to PSYKHE AI's real-time per-user AI-merchandising
                </h3>
                <p>
                  "PSYKHE AI delivered an +18% lift in RPV - but beyond the
                  numbers, they captured the emotional core of how our customers
                  shop. The experience feels more curated, more intuitive, and
                  their system respects the individuality required of our
                  multibrand assortment. It's like giving each visitor their own
                  personal stylist, but smarter and scalable."
                </p>
                <cite>— Beth Buccini, Founder & Owner, Kirna Zabête</cite>
                <p class="methodology-text">
                  <b>Methodology:</b> We ran a clean A/B test over six months on
                  category pages (PLPs). One group used PSYKHE AI's psychographic-powered,
                  real-time PLP ranking; the other relied on the site's existing
                  sort logic. RPV encompasses lift in both average basket value and
                  conversion rate.
                </p>
              </div>
              <div class="case-studies-image">
                <img
                  src="/media/b2b/ww/case-studies/kirna_zabete.png"
                  alt="Beth Buccini, Founder & Owner, Kirna Zabête"
                />
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="psykhe-ai-video-container">
        <div class="psykhe-ai-video-container-in">
          <div class="psykhe-ai-video-container-in-text">
            <h2>Why we're different:</h2>
          </div>
        </div>

        <div>
          <video controls>
            <source
              src="https://s3.eu-west-1.amazonaws.com/media.psykhefashion.com/x/psykhe_ai_compressed.mp4"
              type="video/mp4"
            />
          </video>
        </div>
      </div>

      <div class="as-seen-in-outer">
        <div class="as-seen-in">
          <div class="as-seen-in-text">
            <h2>As seen in:</h2>
          </div>
          <div class="as-seen-in-components">
            <div class="desktop">
              <img src="/media/b2b/ww/logo/logos-desktop.png" alt="Logos" />
            </div>
            <div class="mobile">
              <img src="/media/b2b/ww/logo/logos-mobile.png" alt="Logos" />
            </div>
          </div>
        </div>
      </div>

      <div class="boost-discovery-outer">
        <div class="boost-discovery">
          <div class="boost-discovery-text">
            <h2>Lazy "Personalization" is Losing You Sales</h2>
            <p>
              Mechanical, repetitive, and impersonal: showing best-sellers to
              all, endlessly surfacing lookalikes, and even recommending
              purchases back to you. Your customers deserve better. Our
              AI-merchandising is fully per-user, delivering true
              personalization instead of generic optimization.
            </p>
          </div>
          <div class="boost-discovery-components">
            <div class="boost-discovery-component a">
              <div class="boost-discovery-component-icon">
                <img src="/media/b2b/ww/bd/intuitive-recomendation-ai.svg" />
              </div>
              <h3 class="boost-discovery-component-heading">
                Per-User Psychographic Personalization
              </h3>
              <p class="boost-discovery-component-text">
                We merchandise the entire product category for every user,
                ensuring to surface the right product and quicken the time to
                discovery and purchase, not just mass A/B testing.
              </p>
            </div>

            <div class="boost-discovery-component b">
              <div class="boost-discovery-component-icon">
                <img src="/media/b2b/ww/bd/early-access-program.svg" />
              </div>
              <h3 class="boost-discovery-component-heading">
                Built for Fashion & Interiors
              </h3>
              <p class="boost-discovery-component-text">
                PSYKHE AI's unrivaled team of fashion, psychology, and
                machine&#8209;learning experts have developed our psychographic
                AI to cater to the specific needs of fashion retailers.
              </p>
            </div>

            <div class="boost-discovery-component c">
              <div class="boost-discovery-component-icon">
                <img src="/media/b2b/ww/bd/gain-competitive-advantage.svg" />
              </div>
              <h3 class="boost-discovery-component-heading">
                Instant Personalization for Guest Users
              </h3>
              <p class="boost-discovery-component-text">
                PSYKHE AI personalizes the experience for every single user in
                real&#8209;time, understanding the context of the session, and
                updating the consumer's merchandising every 10 seconds.
              </p>
            </div>
          </div>
        </div>
      </div>

      <div class="signup-outer" id="signup">
        <div class="signup">
          <p id="contact" class="signup-heading">
            Get PSYKHE AI For Your Business
          </p>

          <p class="signup-content">
            Get in touch to discuss your Enterprise's specific needs and get an
            in‑depth understanding of how psych-based AI models deliver the
            experience of a personal shopper at scale.
          </p>

          <div id="success-message" class="subscription-message is-success">
            We'll be in touch.
          </div>
          <div id="error-message" class="subscription-message is-failure">
            Sorry, there has been an error during the registration process.
          </div>

          <form class="subscription-form" id="contact-form">
            <div class="fields">
              <input
                id="firstName"
                name="first_name"
                type="text"
                placeholder="First Name"
                required
              />
              <input
                id="lastName"
                name="last_name"
                type="text"
                placeholder="Last Name"
                required
              />
            </div>

            <div class="fields">
              <input
                id="business_type"
                name="business_type"
                type="text"
                placeholder="Business Type"
                required
              />
              <input
                id="email"
                name="email"
                type="email"
                placeholder="Email"
                required
              />
            </div>

            <button type="submit" id="submit-btn">
              <img class="spinner" src="/media/spinner-b.svg" />
              <span class="submit-text">SUBMIT</span>
            </button>
          </form>
        </div>
      </div>
    </div>
    <Footer />
  </div>
</Layout>

<style lang="scss">
  @use "../styles/app.scss" as *;

  .home-wrapper {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }

  .psykhe-landing {
    flex: 1;
  }
</style>

<script>
  // Handle immediate scroll to anchor on page load to prevent flash
  (function () {
    // Check if there's a hash in the URL
    if (window.location.hash) {
      // Hide the page content immediately to prevent flash
      document.documentElement.style.visibility = "hidden";

      // Wait for DOM to be ready
      document.addEventListener("DOMContentLoaded", function () {
        // Scroll to the target immediately
        const target = document.querySelector(window.location.hash);
        if (target) {
          target.scrollIntoView({ behavior: "smooth", block: "start" });
        }

        // Show the page content
        document.documentElement.style.visibility = "visible";
      });
    }
  })();

  // Handle anchor link clicks for smooth scrolling
  document.addEventListener("DOMContentLoaded", function () {
    // Add smooth scrolling to all anchor links
    const anchorLinks = document.querySelectorAll('a[href^="#"]');
    anchorLinks.forEach((link) => {
      link.addEventListener("click", function (e) {
        const targetId = (e.currentTarget as HTMLAnchorElement).getAttribute(
          "href",
        );
        if (!targetId) return;

        const targetElement = document.querySelector(targetId);
        if (targetElement) {
          e.preventDefault();
          targetElement.scrollIntoView({
            behavior: "smooth",
            block: "start",
          });

          // Update URL without triggering page reload
          history.pushState(null, "", targetId);
        }
      });
    });
  });

  document.addEventListener("DOMContentLoaded", async function () {
    const form = document.getElementById("contact-form") as HTMLFormElement;
    const submitBtn = document.getElementById(
      "submit-btn",
    ) as HTMLButtonElement;
    const successMessage = document.getElementById("success-message");
    const errorMessage = document.getElementById("error-message");

    // Add null checks
    if (!form || !submitBtn || !successMessage || !errorMessage) return;

    // Import the subscription service
    // For testing: use MockSubscriptionService if you're having CORS issues
    // For production: use SubscriptionService
    const isDevelopment = import.meta.env.DEV;

    let subscriptionService;
    if (isDevelopment) {
      console.log(
        "🧪 Development mode: Using mock service to avoid CORS issues",
      );
      const { MockSubscriptionService } = await import(
        "../services/mock-subscription.service"
      );
      subscriptionService = new MockSubscriptionService();
    } else {
      console.log("🚀 Production mode: Using real API service");
      const { SubscriptionService } = await import(
        "../services/subscription.service"
      );
      subscriptionService = new SubscriptionService();
    }

    form.addEventListener("submit", async function (e) {
      e.preventDefault();

      // Show loading state
      submitBtn.classList.add("processing");
      submitBtn.disabled = true;

      // Hide previous messages
      successMessage.classList.remove("show");
      errorMessage.classList.remove("show");

      // Get form data
      const formData = new FormData(form);
      const firstName = formData.get("first_name") as string;
      const lastName = formData.get("last_name") as string;
      const businessType = formData.get("business_type") as string;
      const email = formData.get("email") as string;

      try {
        // Actually submit to API
        console.log("Submitting form data:", {
          firstName,
          lastName,
          businessType,
          email,
        });
        console.log("Current origin:", window.location.origin);

        await subscriptionService.store(
          firstName,
          lastName,
          businessType,
          email,
        );

        // Show success message
        successMessage.classList.add("show");
        form.reset();
      } catch (error) {
        console.error("Form submission error:", error);
        if (error instanceof Error) {
          console.error("Error details:", {
            name: error.name,
            message: error.message,
            stack: error.stack,
          });
        }

        // Check if it's a CORS error
        const errorText =
          error instanceof Error ? error.message : String(error);
        if (errorText.includes("CORS") || errorText.includes("fetch")) {
          console.error(
            "🚨 CORS Error detected! The API only allows requests from https://psykhe.com",
          );
          console.error("Current origin:", window.location.origin);
          console.error(
            "You need to update AWS API Gateway CORS settings or test from the correct domain",
          );
        }

        errorMessage.classList.add("show");
      } finally {
        // Reset button state
        submitBtn.classList.remove("processing");
        submitBtn.disabled = false;
      }
    });
  });
</script>
